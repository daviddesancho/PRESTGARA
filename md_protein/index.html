<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Molecular dynamics - PREST GARA Introduction to molecular simulation techniques</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> PREST GARA Introduction to molecular simulation techniques</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
            <li class="toctree-l1 ">
                <a class="" href="..">Index</a>
                
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../mc/">Monte Carlo</a>
                
            </li>
        

    
        
            <li class="toctree-l1 current">
                <a class="current" href="./">Molecular dynamics</a>
                
                    <ul>
                    
                        <li class="toctree-l3"><a href="#molecular-dynamics-simulations-of-protein-stretching">Molecular dynamics simulations of protein stretching</a></li>
                        
                            <li><a class="toctree-l4" href="#downloading-the-protein">Downloading the protein</a></li>
                        
                            <li><a class="toctree-l4" href="#the-simulation-model">The simulation model</a></li>
                        
                            <li><a class="toctree-l4" href="#parameters-for-the-simulation">Parameters for the simulation</a></li>
                        
                            <li><a class="toctree-l4" href="#setting-up-your-run">Setting up your run</a></li>
                        
                    
                    </ul>
                
            </li>
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">PREST GARA Introduction to molecular simulation techniques</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
    <li>Molecular dynamics</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <h1 id="molecular-dynamics-simulations-of-protein-stretching">Molecular dynamics simulations of protein stretching</h1>
<p>In the second part of our tutorial we will look at another 
application of molecular simulations to nanobiotechnology.
In particular we will focus on trying to reproduce 
signatures of single molecule experiments on proteins
with the atomic force microscope (AFM) from a simple toy
model. The protein we will look at, titin, is in fact of great
interest in the study of protein mechanics. You can learn 
more about this protein exploring this 
<a href="http://pdb101.rcsb.org/motm/185">link</a>. For our calculations
we will use an open source package for running simulatoins called
 <a href="../www.gromacs.org">Gromacs</a>.</p>
<p>Instead of running a proper atomistic simulation including physics-based
interactions considering all the atoms of both protein and solvent, we
will use a coarse-grained model. In particular, we will choose the 
widely used <a href="http://smog-server.org/">SMOG force field</a>, which reduces
the representation of the interactions to a design principle (that the
protein will fold to its native state) and conveniently ignores the 
sorrounding water. Interestingly, the model retains important 
details of the system. </p>
<h3 id="downloading-the-protein">Downloading the protein</h3>
<p>First we will look at our system of interest, consisting of six 
immunoglobulin-like domains from the titin molecule from rabbit.
This structure was downloaded from the Protein Data Bank (PDB), and 
you can access a lot of information by inspecting it (each 
experimental structure has a unique id in the PDB, in this case
<a href="https://www.rcsb.org/pdb/explore.do?structureId=3B43">3B43</a>).
In the webpage for this protein entity, go to the download files
tab and click on <code>PDB format</code>.
Looking at the file is less revealing than visualizing the structure.
This is something we can do running the VMD program. In your terminal
type the following command</p>
<pre><code>$&gt; vmd 3B43.pdb
</code></pre>
<p>This should open the file in a new VMD session, which will allow you
to look at the protein in multiple ways and to generate nice images.</p>
<h3 id="the-simulation-model">The simulation model</h3>
<p>Using the file for the titin domains and the SMOG server we have generated
files we will need to run our simulation. They are stored in the Git 
repository for this class. The first file we will look at is the <code>gro</code> 
file, which is very similar to the PDB file. Run the following command in
your terminal </p>
<pre><code>$&gt; wget https://raw.githubusercontent.com/daviddesancho/PRESTGARA/master/code/TitinPulling/smog/titin6.gro
$&gt; nano titin.14879.pdb.gro
</code></pre>
<p>As you can see, the file contains cartesian coordinates for lots of different
atoms. If you move to the end of the directory you will find three numbers.
They define the simulation box, which is very important for running the 
simulations.</p>
<p>The second file we will download is the so-called "topology" file, which
contains all the details of your molecular interactions. You can download
it in the same way. In your terminal, type</p>
<pre><code>$&gt; wget https://raw.githubusercontent.com/daviddesancho/PRESTGARA/master/code/TitinPulling/smog/titin6.top
$&gt; nano titin.14879.pdb.top
</code></pre>
<p>There are lots of interesting things to see here. The file is divided in 
different sections, where we define the different types of atoms and the
different types of interactions. As you will notice, hydrogen atoms do not
show up because they are not considered in the model. An interesting section
is the <code>[ bonds ]</code> section. It looks like this:</p>
<pre><code> [ bonds ]
 ;ai     aj      func    r0(nm)  Kb
        1        2     1 1.452939779e-01 1.000000000e+04
        2        3     1 1.522609930e-01 1.000000000e+04
        2        5     1 1.530609356e-01 1.000000000e+04
 ...
</code></pre>
<p>For bonded pairs of atoms in our sequence, it defines the bond distance and 
the interaction strength, which as you will remember is determined by a 
harmonic spring constant. The same is true for the <code>[ angles ]</code> section,
 but here each angle needs three atoms. Next we  find the torsion angles, 
defined as a periodic function for groups of 4  atoms. </p>
<pre><code>[ dihedrals ]
;ai  aj  ak  al  func  phi0(deg) kd mult
        1        2        3        4  1 1.137472335e+02 2.287907073e-01 1
        1        2        3        4  1 3.412417005e+02 1.143953537e-01 3
        1        2        3        6  1 2.919004930e+02 2.287907073e-01 1
        1        2        3        6  1 8.757014791e+02 1.143953537e-01 3
</code></pre>
<p>The type of function used here is a Fourier series. We will just finalize
mentioning that the non-bonded interactions here are defined in the <code>[ pairs ]</code>
section. This include the numerators for the 6 and 12 terms in a Lennard-Jones
potential.</p>
<p>All of these interaction terms are defined in great lenghts in the <a href="http://manual.gromacs.org/documentation/">Gromacs
manual</a>. </p>
<h3 id="parameters-for-the-simulation">Parameters for the simulation</h3>
<p>Of course, so far we just have a static protein structure and all the required
 parameters for the interactions. To run dynamics, we must tell the program many 
details on how the simulation must be run. These parameters are specified in the 
<code>mdp</code> file.</p>
<h3 id="setting-up-your-run">Setting up your run</h3>
<p>Usually, preparing a simulation in Gromacs requires <a href="http://www.gromacs.org/Documentation/How-tos/Steps_to_Perform_a_Simulation">multiple 
steps</a>,
 including the minimization of the protein structure, the equilibration of the 
water box and the convergence to a set of pre-defined set of conditions (pressure 
and temperature) at which we want to study our system. In our simple coarse grained 
model things are much simplified. First we will prepare our Gromacs "run input file"
using the following command</p>
<pre><code>$&gt; gro="smog/titin6_longbox.gro"
$&gt; top="smog/titin6.top"
$&gt; mdp="pull.mdp"
$&gt; tpr="pull.tpr"
$&gt; gmx grompp -c $gro -f $mdp -p $top -o $tpr
</code></pre>
<p>This should produce a new <code>pull.tpr</code> file in your directory. Using this <code>tpr</code> file
as input, we can now run our MD simulation.</p>
<pre><code>$&gt; gmx mdrun -v -s pull.tpr -deffnm pull -nt 1 -pf pullf -px pullx
</code></pre>
<p>We will first look at the results using VMD. Again, open a new session from the terminal</p>
<pre><code>$&gt; vmd smog/titin6_longbox.gro
</code></pre>
<p>And now load your trajectory onto the initial structure. What do you see in the simulation?</p>
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../mc/" class="btn btn-neutral" title="Monte Carlo"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
      <span><a href="../mc/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>

<!--
MkDocs version  : 0.12.2
Docs Build Date : 2017-11-23 09:44:17.866184
-->
</body>
</html>